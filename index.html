<!DOCTYPE html> 
<html xmlns:fb="https://www.facebook.com/2008/fbml">

<!--
/***
 *                                                
 *                                         ..     
 *    `7MMF' `YMM'                  OO      `bq   
 *      MM   .M'                    88        YA  
 *      MM .d"  `7MM  `7MM  .gP"Ya  ||     gp `Mb 
 *      MMMMM.    MM    MM ,M'   Yb ||     ""  8M 
 *      MM  VMA   MM    MM 8M"""""" `'         8M 
 *      MM   `MM. MM    MM YM.    , ,,     ,, ,M9 
 *    .JMML.   MMb`Mbod"YML.`Mbmmd' db     db dM  
 *                                          .pY   
 *                                         ''     
 */
-->

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Kue social feed</title>

    </head>
    <body>
<div id="fb-root"></div>
 <script type="text/javascript">

     window.fbAsyncInit = function() {
    FB.init({
      appId      : '213068875558203', // App ID
      channelUrl : '//kue.github.io/FriendOnline/channel.html', // Channel File
      status     : true, // check login status
      cookie     : true, // enable cookies to allow the server to access the session
      xfbml      : true  // parse XFBML
    });


     //get login status
         FB.getLoginStatus(onCheckLoginStatus(response));


  //JS

//OnCheckLoginStatus only works if I have it on the index page. 

function onCheckLoginStatus (response)
    {
     if (response.status != "connected")
     {
      top.location.href = "https://www.facebook.com/dialog/oauth?client_id=" + appId + "&redirect_uri=" + encodeURIComponent (redirectUrl) + "&scope=user_photos,friends_photos_email,user_birthday,user_about_me";
     }
     else
     {
     console.log("connected"); 


      $.ajax({
        url : "http://sxxxxx/bn/s_Request.php",
        type : 'POST',
        data: {signed_request: response.authResponse.signedRequest},
        success : function (result) {
           console.log("success");
           console.log(result);
        },
        error : function () {
           alert("error parsing signed request");
        }
    });


      // Start the application (this is just demo code)!
      $(document.body).append ("<p>Authorized!</p>");

     }
    } 
        </script>
 
    </body>
</html>